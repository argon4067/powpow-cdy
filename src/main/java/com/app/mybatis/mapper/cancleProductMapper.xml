<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cancleProduct">
	<insert id="insert" parameterType="CancleProductVO">
		INSERT INTO TBL_CANCLE_PRODUCT(ID, MEMBER_ID, PRODUCT_ID)
		VALUES(CANCLE_PRODUCT_SEQ.NEXTVAL, #{memberId}, #{productId})
	</insert>
	
	<select id="selectByDate" resultType="CancleProductDTO">
		SELECT SUM(PRODUCT_COUNT) AS ONE_DAY_TOTAL_COUNT, SUM(PRODUCT_COUNT * PRODUCT_PRICE) AS ONE_DAY_TOTAL_PRICE
		FROM TBL_CANCLE_PRODUCT TCP
		JOIN TBL_MEMBER TM 
		ON TCP.MEMBER_ID = TM.ID
		JOIN TBL_PRODUCT TP 
		ON TCP.PRODUCT_ID = TP.ID
		JOIN TBL_SELLER TS 
		ON TP.SELLER_ID = TS.ID
		WHERE TS.ID = #{sellerId} AND DATE 
		BETWEEN TO_DATE('2023-11-01', 'YYYY-MM-DD')
		AND TO_DATE('2023-11-30', 'YYYY-MM-DD')
		ORDER BY TCP.ID DESC
	</select>
</mapper>